<div class="w-full mb-10 flex items-center flex-no-wrap justify-between">
	<h3 lang langLabel="bienes-muebles:nombre-componente"
		class="font-bold m-0 display-block w-full m-0">{{nombreComponente}}</h3>
	<button (click)="ObtenerTodo()" nz-button nzType="text" nz-tooltip [nzTooltipTitle]="titleTemplate">
		<i nz-icon nzType="reload" nzTheme="outline"></i>
	</button>
	<ng-template #titleTemplate>
	<span lang langLabel="vs-tooltip:recargar">
		Volver a cargar
	</span>
	</ng-template>
</div>

<form nz-form [formGroup]="form">
	<div class="grid flex-align-items-center">

		<div class="grid-col-2">
			<p lang langLabel="bienes-muebles:tipo-bien-mueble" class="label">Tipo de Bien Mueble</p>
			<nz-form-item>
				<nz-form-control nzHasFeedback [nzErrorTip]="combineTpl">
					<vs-select-bien-mueble (ngModelChange)="setearCodigoReferencia()" class="w-full"
										   formControlName="tipoBienMueble"></vs-select-bien-mueble>
					<ng-template #combineTpl let-control>
						<ng-container *ngIf="control.hasError('required')">
							<p lang langLabel="vs-formulario:requerido">El campo es requerido</p>
						</ng-container>
					</ng-template>
				</nz-form-control>
			</nz-form-item>
		</div>

		<div class="grid-col-2">
			<p lang langLabel="bienes-muebles:codigo-referencia" class="label">Código de referencia:</p>
			<nz-form-item>
				<nz-form-control nzHasFeedback [nzErrorTip]="combineTpl2">
					<input vs-trim nz-input (ngModelChange)="validaPlaca($event)" formControlName="codigoReferencia"
						   class="w-full">
					<ng-template #combineTpl2 let-control>
						<ng-container *ngIf="control.hasError('required')">
							<p lang langLabel="vs-formulario:requerido">El campo es requerido</p>
						</ng-container>
						<ng-container *ngIf="control.hasError('maxlength')">
							<p lang langLabel="vs-formulario:maxLength-veinte">La longitud máxima del texto es 20
								caracteres</p>
						</ng-container>
					</ng-template>
				</nz-form-control>
			</nz-form-item>
		</div>

		<div class="grid-col-2">
			<p lang langLabel="bienes-muebles:avaluo-comercial" class="label">Avalúo Comercial:</p>
			<nz-form-item>
				<nz-form-control nzHasFeedback [nzErrorTip]="combineTpl">
					<nz-input-number decimalSeparator class="w-full" [nzMin]="0" formControlName="avaluoComercial"
									 [nzFormatter]="formatterDollar" [nzParser]="parserDollar"></nz-input-number>
					<ng-template #combineTpl let-control>
						<ng-container *ngIf="control.hasError('required')">
							<p lang langLabel="vs-formulario:requerido">El campo es requerido</p>
						</ng-container>
					</ng-template>
				</nz-form-control>
			</nz-form-item>
		</div>

		<div class="grid-col-4">
			<p lang langLabel="bienes-muebles:descripcion" class="label">Descripción:</p>
			<nz-form-item>
				<nz-form-control nzHasFeedback [nzErrorTip]="combineTpl">
					<textarea nz-input formControlName="descripcion" class="w-full" nzAutosize></textarea>
					<ng-template #combineTpl let-control>
						<ng-container *ngIf="control.hasError('required')">
							<p lang langLabel="vs-formulario:requerido">El campo es requerido</p>
						</ng-container>
						<ng-container *ngIf="control.hasError('maxlength')">
							<p lang langLabel="vs-formulario:maxLength-dos-cientos">La longitud máxima del texto es 200
								caracteres</p>
						</ng-container>
					</ng-template>
				</nz-form-control>
			</nz-form-item>
		</div>


		<!--<div class="grid-col-2">
			<p class="label" style="opacity: 0;">.</p>
			<button nz-button class="w-full" nzType="primary" (click)="IngresarFila()">{{_accion}}</button>
		</div>-->
		<div class="grid-col-2">
			<p class="label" style="opacity: 0;">.</p>
			<div class="flex items-center flex-no-wrap w-full">
				<button nz-button nzType="primary" class="w-full" (click)="IngresarFila()">
					<div lang langLabel="bienes-muebles:insertar-bien-mueble"
						 *ngIf="_accion === 'Insertar'; else elseBlock">Insertar
					</div>
					<ng-template #elseBlock>
						<div lang langLabel="bienes-muebles:actualizar-bien-mueble">
							Actualizar
						</div>
					</ng-template>
				</button>
				<button *ngIf="_accion !== 'Insertar'"
					(click)="ResetearVista()"
					nz-tooltip nzTooltipTitle="Nuevo registro"
					nz-button style="width: 4rem;" class="ml-7"><i nz-icon nzType="plus" nzTheme="outline"></i></button>
			</div>
		</div>

	</div>
</form>


<div class="w-full pt-20">
	<nz-table [nzShowPagination]="false" nzSize="small" [nzLoading]="cargando.listar" [nzData]="listaBienesMuebles">
		<thead>
		<tr>
			<th lang langLabel="bienes-muebles:tipo-bien-mueble">Tipo de Bien Mueble</th>
			<th lang langLabel="bienes-muebles:codigo-referencia">Referencia</th>
			<th lang langLabel="bienes-muebles:avaluo-comercial">Avaluo Comercial</th>
			<th lang langLabel="bienes-muebles:descripcion">Descipción</th>

			<th class="min-size"></th>
		</tr>
		</thead>
		<tbody>
		<ng-container *ngFor="let data of listaBienesMuebles; let i = index">
			<ng-container *ngIf="data.accion != accionesHtml.Eliminar">
				<tr>
					<td>{{ ObtenerNombreMueblePorCodigo(data.objeto.tipoBienMueble) }}</td>
					<td>{{ data.objeto.codigoReferencia }}</td>
					<td>{{ data.objeto.avaluoComercial | currency }}</td>
					<td>{{ data.objeto.descripcion }}</td>

					<td>
						<div class="flex items-center flex-no-wrap">
							<button nz-tooltip [nzTooltipTitle]="titleEditar" nz-button nzType="text" class="mr-7"
									(click)="EditarFila(data,i)">
								<i nz-icon nzType="edit" nzTheme="outline"></i>
							</button>

							<button
							nz-popconfirm
							[nzPopconfirmTitle]="titleConfirmarEliminar"
							(nzOnConfirm)="EliminarFila(i)"
							nz-tooltip [nzTooltipTitle]="titleEliminar" nz-button nzType="text"
									class="text-red-600 hover:text-red-800" >
								<i nz-icon nzType="delete" nzTheme="outline"></i>
							</button>
							<ng-template #titleEditar>
								<span lang langLabel="vs-tooltip:editar">Editar</span>
							</ng-template>
							<ng-template #titleEliminar>
								<span lang langLabel="vs-tooltip:eliminar">Eliminar</span>
							</ng-template>
							<ng-template #titleConfirmarEliminar>
								<span lang langLabel="vs-tooltip:confirmar-eliminar">Eliminar</span>
							</ng-template>
						</div>
					</td>
				</tr>
			</ng-container>
		</ng-container>
		</tbody>

	</nz-table>
</div>

<div class="w-full pt-20 text-right" *ngIf="mostrarGuardar">
	<!--<button nz-button nzType="primary" [nzLoading]="cargando.guardar" class="vs-btn-green" (click)="GuardarBase()">
			Guardar cambios
		</button>-->
</div>
